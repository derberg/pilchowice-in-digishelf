<header class="relative z-50 bg-gradient-to-r from-[#b5a896] via-[#c19f80] to-[#3c2a21] p-2">
  <nav class="container mx-auto flex justify-between items-center">
    <!-- Logo + Title -->
    <div class="flex items-center gap-4">
      <img src="/logo.avif" alt="Archiwa Pilchowic" class="h-12 w-auto" />
      <a href="/" class="text-sm text-[#3c2a21] font-bold">Archiwa Pilchowic</a>
    </div>

    <!-- Navigation + Search Trigger -->
    <div class="flex items-center gap-4">
      <a href="/zrodla" class="text-sm text-white font-bold">ŹRÓDŁA</a>
      <a href="/zasoby" class="text-sm text-white font-bold">ZASOBY</a>
      <button id="searchToggle" class="p-2 hover:opacity-80 focus:outline-none">
        <!-- Heroicons magnifying glass -->
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
        </svg>
      </button>
    </div>
  </nav>

  <!-- Configuration to disable CSE history -->
  <script is:inline>
    window.__gcse = {
      parsetags: 'explicit',
      callback: () => {
        google.search.cse.element.render({
          div: 'searchBox',
          tag: 'search',
          attributes: { enableHistory: false }
        });
      }
    };
  </script>

  <!-- CSE container and loader -->
  <div id="searchBox" class="fixed top-16 right-4 w-80 bg-white rounded shadow-lg p-2 hidden z-[9999]"></div>
  <script async src="https://cse.google.com/cse.js?cx=b6159d59b7c2a4a9b"></script>

  <!-- Toggle Logic -->
  <script is:inline>
    const toggle = document.getElementById('searchToggle');
    const box    = document.getElementById('searchBox');
    toggle.addEventListener('click', () => box.classList.toggle('hidden'));
    document.addEventListener('click', (e) => {
      if (!box.contains(e.target) && !toggle.contains(e.target)) {
        box.classList.add('hidden');
      }
    });
    // Initial cleanup in case hash is present
    if (location.hash.startsWith('#gsc.')) {
      history.replaceState(null, '', window.location.pathname);
    }
  </script>